<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Property Listings</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
  </head>
  <body>
    <div *ngIf="!loggedIn">
        <img style="padding-left: 50px;" src="/assets/log-in.gif" />
    </div>
    <!-- <asl-google-signin-button
    *ngIf="!loggedIn"
  ></asl-google-signin-button> -->
    <div *ngIf="loggedIn">

    <!-- mortgage created output passes to New Mortgate to trigger event (mortgate created) -->
    <!-- mortgage created is used for searching.  -->
    <!-- parent component -->
    <div>
      <app-mortgage-form
        (MortgageCreated)="NewMortgage($event)"
        (NumBeds)="NumBeds($event)"
        (ManagementFee)="ManagementFee($event)"
        (VacancyRate)="VacancyRate($event)"
      ></app-mortgage-form>

      <div *ngIf="loading" class="loading">
        <img src="/assets/loadingLogo.gif" alt="Loading..." />
      </div>
      <p>{{status}}</p>

      <div class="page-container">
        <div class="content-container">
          <!-- Property Cards Go Here (Generated by Angular) -->
          <!-- Structural directives. ng if is used to display the options that match the users inputs and ng for loops through and displays all that match.  -->
          <div *ngIf="displaySearchResult && PropertyListResult.data != null">
            <div *ngFor="let p of PropertyListResult.data.home_search.results" class="property-card">
              <i
              class="heart-icon fas fa-heart"
              (click)="AddFavorites(user.id, p.property_id)"
              id="heart"
            ></i>

              <div class="left-side">
                <p>
                  <a [routerLink]="['/property-details', p.property_id]">
                    <img 
                      *ngIf="p.primary_photo?.href != null"
                      src="{{ p.primary_photo?.href }}"
                  /></a>
                </p>
              
              <!-- <app-heart [userId]="user.id" [propertyId]="p.property_id"></app-heart> -->

              <!-- <i class="fas fa-heart" [ngClass]="{'favorited': favorited, 'not-favorited': !favorited}" (click)="ToggleFavorite(user.id, p.property_id, favorited)"></i> -->

              <!-- <div id="heart" *ngIf="!favorited" (click)="AddFavorites(user.id, p.property_id)"><i class="fas fa-heart"> </i></div>
              <div id="heart" *ngIf="favorited" (click)="RemoveFavorite(user.id, p.property_id)"><i class="fa fa-heart"> </i></div> -->
              <p *ngIf="p.primary_photo?.href == null">
                <img src="https://en.pimg.jp/072/139/682/1/72139682.jpg" />
              </p>

              <!-- Interface values are pulled from API -->
              <h3>{{ p.list_price | currency }}</h3>
              <p>
                {{ p.location.address.line }},
                <br>
                {{ p.location.address.city }},
                {{ p.location.address.state_code }}
                {{ p.location.address.postal_code }}
              </p>
              <p>
                <strong
                  >{{ p.description.beds }} Beds &nbsp;
                  {{ p.description.baths }} Baths &nbsp;
                  {{ p.description.sqft }} Square Feet</strong
                >
              </p>
            </div>

              <!-- <p>Median Rental Rate: {{PropertyListResult.data.geo.geo_statistics.housing_market.median_rent_price}}</p> -->
              <div class="right-side">
                <app-mortgage-result
                  [DisplayResult]="p"
                  [User]="appUser"
                  [Rent]="averageRent"
                  [vacancyRate]="appUser.vacancyRate"
                  [managementFee]="appUser.managementFee"
                  [AverageRates]="averageRates"
                ></app-mortgage-result>
              </div>
            </div>
          </div>
        </div>
          <!-- Event triggers api calls, which are used to display search results, calculate average rates.  -->
      <div class="map-container">
        <app-map [listPins]="PropertyCoordinates"></app-map>
      </div>
      </div>
      
      <!-- <button id="heart" (click)="AddFavorites("4200",p.property_id)"i class="fas fa-heart"></i>hi </button> -->

      <!-- None object oriented map -->

      <!-- <h1>{{WaitAMinute}}</h1> -->
      <!-- <google-map height="500px"
            width="900px"
            [center]="center"
            [zoom]="zoom"
            (mapClick)="moveMap($event)"
            (mapMousemove)="move($event)"> -->

      <!-- <map-marker *ngFor="let markerPosition of coordinates" [position]="{lat:markerPosition.lat, lng:markerPosition.lon}" [label]="'bob'" (mapClick)="Click()"></map-marker> -->

      <!-- 
  <P>hi</P>
<map-marker  *ngFor="let markerPosition of PropertyCoordinates" [position]="{lat:markerPosition.lat, lng:markerPosition.lon}" (mapClick)="Click()"></map-marker>
  -->
      <!-- <div *ngIf="listPins.data.home_search.results.length!=0">
        <map-marker  *ngFor="let markerPosition of GetStartCoordinates()" [position]="{lat:markerPosition.lat, lng:markerPosition.lon}" (mapClick)="Click()"></map-marker>
    </div>  -->
      <!-- </google-map> -->
    </div>
    <!-- Both the Mortgate Form and Mortgage Result components make up these pages.  -->
    </div>
  </body>
</html>
